# 信号与系统

用$x(t)$表示连续时间信号，$x[n]$表示离散时间信号

## LTI系统

线性时不变（Linear Time Invarient，LTI）系统是主要的讨论对象。其定义是

- 线性：设输入为$x_1(t)$时输出为$y_1(t)$，输入$x_2(t)$时输出为$y_2(t)$，则输入为$x_1(t) + x_2(t)$时输出为$y_1(t) + y_2(t)$
- 时不变性：输入为$x(t-\tau)$时输出为$y(t-\tau)$

设输入为单位冲激信号$\delta(t)$时，输出为$h(t)$，将其称作单位冲激响应，$h(t)$完全描述了LTI系统性质：当输入为$x(t)$时，输出为$x(t) * h(t) = \int_{-\infty}^{\infty} x(\tau) h(t-\tau) d\tau$；或者从频域看，输出为$X(s) H(s)$

# 傅里叶变换家族

| 变换           | 时域特性     | 频域特性     |
| -------------- | ------------ | ------------ |
| 傅里叶变换     | 连续，非周期 | 非周期，连续 |
| 傅里叶级数     | 连续，周期   | 非周期，离散 |
| 离散傅里叶变换 | 离散，非周期 | 周期，连续   |
| 离散傅里叶级数 | 离散，周期   | 周期，离散   |

可以看出，时域连续 - 频域非周期；时域周期，频域离散，反之亦然

## 傅里叶变换

$x(t)$连续、非周期；$X(j\omega)$非周期、连续

$X(j\omega) = \int_{-\infty}^{+\infty} x(t) e^{-j\omega t} dt$

$x(t) = \frac{1}{2\pi} \int_{-\infty}^{+\infty} X(j\omega) e^{j\omega t} dt$

## 傅里叶级数

$x(t)$连续、周期；$a_k$非周期、离散

$a_k = \frac{1}{T} \int_T x(t)e^{-j k \omega_0 t} dt$

$x(t) = \sum_{k=-\infty}^{\infty}a_k e^{jk\omega_0t}$

## 离散傅里叶变换

$x[n]$离散、非周期，$X(e^{j\omega})$周期、连续

$X(e^{j\omega}) = \sum_{-\infty}^{+\infty} x[n] e^{-j \omega n}$

$x[n] = \frac{1}{2\pi} \int_{2\pi} X(e^{j\omega}) e^{j\omega n} d\omega$

## 离散傅里叶级数

$x[n]$离散、周期，$X(e^{j\omega})$周期、离散

$a_k = \frac{1}{N} \sum_{n=N} x[n] e^{-j k \omega_0 n}$，其中$\omega_0 = \frac{2\pi}{N}$

$x[n] = \sum_{k=<N>} a_k e^{j k \omega_0 n} $

# 拉普拉斯变换

$X(s) = \int_{-\infty}^{+\infty} x(t) e^{-st} dt$

$x(t) = \frac{1}{2\pi j} \int_{\sigma - j\infty}^{\sigma + j\infty} X(s)e^{st} ds$（一般不用反变换，而是用一阶系统的变换和收敛域推出反变换）

拉普拉斯变换**与傅里叶变换的关系**是

- 拉普拉斯变换可以看作傅里叶变换在复平面的扩展。傅里叶变换相当于虚轴上的拉普拉斯变换
- 傅里叶变换主要用于分析频谱，拉普拉斯变换主要用于求解微分方程与分析系统稳定性

## 收敛域

设$s = \sigma + j\omega$，则拉普拉斯变换相当于给信号乘上$e^{-\sigma t}$再做傅里叶变换，收敛性与$\sigma$有关，收敛域总是与虚轴平行。对于有理的$X(s)$，收敛域（Range of Convergence，ROC）被极点界定

- 有限、绝对可积的信号：s平面
- 右边信号（定义在$t \gt t_0$的信号）：最右侧极点右边
- 左边信号（定义在$t \lt t_0$的信号）：最左侧极点左边

## 性质

|              | 时域                               | S域                |
| ------------ | ---------------------------------- | ------------------ |
| 时域一阶微分 | $x^{\prime}(t)$                    | $sX(s) - x(0)$     |
| 时域微分     | $x^{(n)}(t)$                       |                    |
| 时域积分     | $\int_{-\infty}^{t} x(\tau) d\tau$ | $\frac{1}{s} X(s)$ |
| s域一阶微分  |                                    |                    |

## 常用拉普拉斯变换

| x(t)                 | X(s)                   | ROC                 | 备注           |
| -------------------- | ---------------------- | ------------------- | -------------- |
| $\delta(t)$          | 1                      | 全平面              |                |
| $u(t)$               | $\frac{1}{s}$          | $Re(s) \gt 0$       | 积分器         |
| $e^{-\alpha t} u(t)$ | $\frac{1}{s + \alpha}$ | $Re(s) \gt -\alpha$ | $\alpha \gt 0$ |

## 极零点定性分析

极点与冲击响应波形关系是

- 实轴：指数衰减（左半平面，稳定极点） / 指数增长（右半平面，不稳定极点）
- 虚轴：正弦震荡
- 原点：直流
- 共轭极点对：震荡衰减（左半平面） / 震荡增长（右半平面）

零点影响幅度、相位，不影响波形变化规律

# Z变换

$X(z) = \sum_{n=-\infty}^{+\infty} x[n] z^{-n}$

相当于离散时间域内的拉普拉斯变换。S平面虚轴相当于Z平面单位圆，左半平面相当于Z平面单位圆外，右半平面相当于Z平面单位元内

## 性质

|        | 时域                        | Z域                         |
| ------ | --------------------------- | --------------------------- |
| 升采样 | 两点中间插K-1个0            | $X(z^k)$                    |
| 降采样 | $x[nK]$                     |                             |
| 差分   | $x[n] - x[n-1]$             | $(1-z^{-1}) X(z)$           |
| 累加   | $\sum_{k=-\infty}^{n} x[k]$ | $\frac{1}{1 - z^{-1}} X(z)$ |

# 正交采样

## 希尔伯特变换

数学定义略。物理意义是将所有频率成分偏移90°

设调制信号$x(t)$，其Hilbert变换$H[x(t)] = y(t)$，解析表示$u(t) = x(t) + jy(t)$

特别地，设$x(t) = a(t) \cdot cos(\omega_0 t + \theta(t))$，则$y(t) = a(t) \cdot sin(\omega_0 t + \theta(t))$，将解析表示除以载频分量$e^{j \omega_0}$，得到基带信号$u(t) = a(t) \cdot e^{j\theta(t)}$，可以计算瞬时幅度$a(t)$和瞬时相位$\theta(t)$

解析表示的实部称作同相分量（Inphase Componeng，通常用`I`表示），虚部称作正交分量（Quardrature Component，常用`Q`表示），则振幅$a(t) = \sqrt{I^2 + Q^2}$，相位$\phi(t) = atan(Q/I)$

## 混频正交变换

对于窄带信号，用两个相位相差90°的本振与信号相乘，再经过低通滤波，就能得到同相分量`I`和正交分量`Q`

可以分为模拟域的模拟混频（需要两个ADC，以及正交性很高的本振）或者数字混频（对ADC和数字滤波的要求比较高）

# 窗函数

```mermaid
graph LR
    A("时域连续、无穷<br/>频域连续、无穷")
    A --采样--> B("时域离散、无穷<br/>频域连续、有限")
    B --截断--> C("时域离散、有限<br/>频域连续、有限")
    C --周期延拓--> D("时域离散、周期<br/>频域离散、有限")
```

- 时域采样，频域混叠
  - $x[n] = \int_{-\infty}^{+\infty} x(t) \delta(t-nT_s) dt$
  - $X(e^{j\omega}) = \sum_{k=-\infty}^{+\infty} X(j\omega+2k\pi)$
- 时域加窗，频谱变形
  - $x'[n] = x[n]w_{rect}[n]$，“截断”之后仍视作无穷长序列，只不过其他的点都是0
  - $X'(e^{j\omega}) = X(e^{j\omega}) * W(e^j\omega)$
- 时域周期延拓，频域采样
  - $X[k] = \int_{-\infty}^{+\infty} X(e^{j\omega}) \delta(\omega - 2\pi k / N) d\omega$

假设采样正弦波，加矩形窗，则$X'$为sinc函数。采样整数个周期时，对应正弦波频率的k刚好采到sinc函数正中心，其他点采到0；采的不是整数个周期时，频域采样各个点采到的都不是0，即频谱泄露

主瓣宽度≈主峰宽度，**主瓣越窄，频率分辨能力越强**；旁瓣高度≈泄露强度，**旁瓣越低，幅度分辨能力越强**

# 模拟滤波器

# 数字滤波器

无限脉冲响应（Infinite Impulse Response，IIR）滤波器：
$$
H(z) = \frac{
    \sum_{r=0}^{M} b^r z^{-r}
}{
    1 + {\sum_{k=1}^{N} a_k z^{-k}}
}

\\

y[n] = \sum_{r=0}^M b_r x[n-r] + \sum_{k=1}^N a_k y[n-k]
$$
有限脉冲响应（Finite Impulse Response，FIR）滤波器：
$$
H(z) = \sum_{n=0}^{N-1} h[n] z^{-n}

\\

y[n] = \sum_{k=0}^{N-1} h[k] \cdot x[n-k]
$$

## 滤波器结构

不同结构可以实现相同的传输函数，但是，其精度（舍入误差）、稳定性（溢出）、面积、功耗等可能有差别

**IIR滤波器结构**

- 直接Ⅰ型
- 直接Ⅱ型
- 级联型
- 并联型

待补充

**FIR滤波器结构**

- 直接型
- 级联型
- lattice structure

## IIR滤波器设计

待补充

## FIR滤波器设计

$$
H(z) = \sum_{n=0}^{N-1} h[n] z^{-n}
$$

**线性相位条件**

滤波器会带来相移。设滤波器相频响应是$\phi(\omega)$，令其为线性函数$\phi(\omega) = - \omega \tau$，即$H(\omega) = A(\omega) e^{-j \omega \tau}$，则频率为$\omega$的信号经滤波器延迟后为$sin(\omega t - \omega \tau) = sin(\omega (t - \tau))$

对任何频率，都产生固定延迟$\tau$。反之，如果相频响应不是线性，对不同频率的延迟不同，将造成信号畸变

线性相位条件为单位脉冲响应对称

- 奇对称：$h[n] = -h[N-1-n]$
- 偶对称：$h[n] = h[N-1-n]$

**窗函数设计法**

理想滤波器的响应$h_d[n]$是无限长的，通过给它加窗成为有限长的响应$h[n] = h_d[n] w[n]$，由过渡带宽、阻带衰减的要求，选定窗形状与长度，获得FIR系统函数

**频域取样设计法**

待补充

