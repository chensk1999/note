# SPI interface

串行外设接口（Serial Peripheral Interface）是一种同步串行通信接口规范，广泛用于IC控制。因为SPI是同步接口，它的速度比UART等异步协议（一般最高1MHZ）快，能到数十MHz。由于SPI是单端接口而不是差分接口，不适合长距离（比如远于1米）传输

SPI有一个Master和若干个Slave，一般Master就是MCU，Slave是各种IC，如存储器

有四个控制信号：

1. SCLK: Serial Clock
2. MOSI: Master Out Slave In
3. MISO: Master In Slave Out
4. <span style="text-decoration:overline">SS</span>: Slave Select

传输总是由Master发起，拉低SS之后就开始双向传输，没有其他的交流。根据MISO和MOSI在时钟的上升、下降沿传输，有四种模式，Master和Slave必须用同一种模式

# 阻碍音

阻碍音是音素种类之一，其调音方法为阻碍气流流出。所有辅音都是阻碍音，大多数阻碍音都是辅音

| 语言   | 国际音标  | 例字         |
| ------ | --------- | ------------ |
| 普通话 | t, tʰ     | 对，退       |
| 英语   | tʰ, t / d | train, drain |
| 日语   | t, d      | た，だ       |

补充：音素有很多种分类方法，比如按调音方法分为阻碍音、响音等，按调音部位分为唇音、齿音、舌音等

## 按照调音机制分

### 塞音

阻塞声道使气流停止，除阻时气流流出爆发成声（也有不爆发出声的情况，即无声除阻 No Audible Release / Unreleased Stop，比如 sad 中的 d，doctor 中的 k 音，粤语的“八”）

塞音英文是 Plosive，也称 Occlusive，Stop。其中 stop 强调气流停止阶段，Plosive 强调爆发阶段

| 国际音标 | 中文例字 | 日文例字 |
| -------- | -------- | -------- |
| kʰ       | 看       |          |
| k        | 干       | か       |
| g        |          | が       |

p、k、t 都是常见的塞音。上述例子的三行分别是送气清音、不送气清音、浊音。中文里没有浊音，日文没有强送气清音，详见后文清音与浊音

### 擦音

发声器官形成狭窄通道，气流通过时产生湍流发出摩擦音

| 国际音标 | 中文例字 | 英文例字 |
| -------- | -------- | -------- |
| s        | 思       | sip      |
| z        | 资       | zip      |

### 塞擦音

塞音后面跟着同一发声器官产生的擦音。塞擦音是一个音还是两个音好像有一定模糊性

## 按照清浊分

### 送气与不送气

送气（Aspirate）与不送气（Unaspirate）区别于阻碍音除阻时有没有强烈的气流喷出。国际音标用上标 h（ʰ）来表示送气音。一个简单的辨别方法是发音时将一张纸巾悬于口前，观察发音时纸巾被气流吹动的程度。可以回顾塞音的中文例子

注意：没有完全不送气的音（因为完全不送气就只能发咂嘴声），只有相对的送气强弱。更详细的定量分析可以参见后文 VOT 部分

- 普通话送气与否具有分辨音位的作用，比如“兔子跑了”中的兔和跑都送气、“肚子饱了”中的肚和饱都不送气，中文使用者能听出两者区别，但日文使用者往往不能
- 日语送气与否不能区分音位，比如わたし中间的た不送气，听来像中文的 da 音、たまご开头的た送气，像中文的 ta 音（但是送气程度仍然不如中文 ta），但日文使用者认为两者只是语调区别

### 清音与浊音

清音（Voiceless Sound）与浊音（Voiced Sound）区别于发音时声带震动与否。清浊与送气情况可以进一步组合为四种：送气清音、不送气清音、送气浊音、不送气浊音。其中送气浊音比较少见，多数辅音属于另三种

- 普通话没有浊音
- 日语有清浊之分，日语吴音保留了中古汉语的清浊区别
- 英语传统上分清浊，但现代已经清化，不以清浊而是（类似普通话）以送气与否来区分音位
- 印度语包含送气清音、不送气清音、送气浊音、不送气浊音四种，非常独特

### VOT

VOT（voice onset time），中文译作发声起始时间、浊音起始时间、初浊，指塞音除阻时刻到声带开始震动所经过的时间。它揭示了清与浊、送气与不送气之间的关联

- 送气清音在除阻之后会持续喷出气流一段时间，因此VOT较长（大于50 ms）
- 不送气清音在除阻之后马上开始发音，因此VOT较短（0~30 ms）
- 不送气浊音在除阻之前就开始发音，因此VOT小于0
- 送气浊音的VOT和不送气浊音相似，但是两者喉部运动不同。这说明VOT不足以完全解释清浊，但是由于送气浊音比较少见，一般可以无视

```
    浊音        不送气清音        送气清音
------------------------------------------> VOT
```

“普通话以送气与否区分音位”和“日语以清浊区分音位”的区别在VOT理论中得到统一。两种语言都通过VOT区分音位，但是普通话的分界线靠右，在不送气清音和送气清音中间；日语的分界线靠左，在浊音与不送气清音中间

# 菜刀

## 材料

### 编号

国标不锈钢编号：`<含碳量万分比><元素符号><含量百分比>`，比如说 06Cr19Ni10 含有万分之6的碳、19%的铬和10%的镍（旧版国标的含碳量是千分比）。而且，国标允许含量在一定范围内浮动，实际含量一般比这个数值低）。有时会简称为旧国标数字+铬，比如说含碳量千分之5的简称为五铬钢

美标：用数字标识，比如说304

### 成分

- 铁：基础
- 碳：提高硬度。同时降低韧性，更容易锈蚀。
  - 低碳钢：含碳量小于0.4%，硬度低韧性好，制作的刀锋利度保持很差，需要经常磨刀
  - 中碳钢：含碳量0.5%~0.7%，硬度和韧性都适中
  - 高碳钢：含碳量0.8%~1%，硬度较高，用来锻刀锋利度保持很好。但是因为韧性不足，不适合斩骨
- 铬：提高耐腐蚀性。低碳钢要至少12%的铬，中碳钢15%左右，高碳钢16%~18%
- 镍：提高韧性
- 钨、钼、钒、钴等：一般只有高级钢材才会用到，提供特殊性能

注意成分不是一切，冶炼方法也会影响合金性能。有的刀会使用夹钢工艺——低端产品通过夹钢把好钢用在刀刃上，高端产品夹钢主要是为了外观

# Voiceroid2

## 界面介绍

![](../images/voiceroid2_interface.png)

1. 音源：ボイスプリセット，选择朗读用的音源
2. 文本：テキストボックス，输入文本的地方
3. 调音：チューニング，主要的调音工作区域
   1. マスター：全局的声音（音声効果）、停顿（ポーズのの長さ）、停顿符号（記号ポーズ）设置。一般不在这里进行调音，最多调整一下音量和停顿符号
   2. ボイス：对音源进行调整，具体在工作流里面介绍
   3. フレーズ：对语句进行调整
   4. 単語：记录特殊词汇

## 常规工作流

音源调整

1. 创建自定义音源：ボイス ‐ ユーザ ‐ 新規/コピー
2. 音源调整：チューニング - ボイス
   1. プリセット名：音源名称，可以任意更改
   2. ボイス：音源种类，可以换角色。另外，据说创建一个琴葉茜的音源，然后把音源种类换成其他角色，就能让其他人说关西话了
   3. 音声効果：基本的声音调整滑条。调整方法：拖动；滚轮；输入数字；点击滑条轨道（点击增减0.01，shift+点击增减0.1）
   4. ポーズのの長さ：停顿，如果没有选中选框就不能编辑，不过一般不需要编辑它
   5. スタイル：只有v2角色才有此项，能做出更细致的情感调节
3. 保存（チューニング框左下角）。编辑后未保存的音源右上角会显示星号

语句调整

1. アクセント：以语句（アクセント句）为单位调整各单词的音调和停顿
   1. アクセント句：右键小圆点（アクセントマーク），选择アクセント句を結合 / アクセント句を分割。两个语句中间会显示一段空白，而同一个语句内的不同音节有一条细线相连
   2. 停顿：右键P符号删除停顿（ポーズを削除）或者更改停顿（未变灰的ポーズを挿入），或者右键语句间空白添加停顿。较小的P符号代表短停顿，较大的P符号代表长停顿，带有数字的P符号表示任意长停顿
   3. 音调：上下拖动小圆圈
   4. 更改读音（モーラ）：右键小圆点 - 読み編集。很多时候直接改文本更方便
   5. 无声化：右键小圆点 - 無声化，或者左键读音。无声化指元音不发音的现象，比如あした中间的し没有声带振动。默认自动无声化，一般不需要改。如果应该无声化的音没有无声化，听上去像是读得太用力了；如果不该无声化却无声化，会稍微有一点吞音（不太明显）；将不能无声化的音设置无声化好像没有效果
   6. 句末音调（語尾）：右上角的选单，句尾声调从低到高是断定、通常、呼びかけ、疑問
2. 音量、話速、高さ、抑揚：点击设置值，shift+点击增减0.01，ctrl+点击清除，滚轮滚动增减0.01，点击黑色方块清除。另外，此处的设置和ボイス的设置相乘得到真实值，比如音源高さ1.5，调音高さ1.8，得到1.5×1.8=2.7。但高さ最大值为2，因此朗读时的真实高さ为2
3. 保存（フレーズ框下方的登録）
4. 语句调整比较玄学，只要声音自然就好。如果不确定，可以找真人声音作为参考

朗读/保存：文本框下面的再生、音声保存。随便试试就懂了

## 其他功能

注音（ルビ）：选中文本 - 右键 - ルビ挿入，或者直接编辑文本（例：＜＜試作品｜プロトタイプ＞＞）。至多用16个，并且不能带标点。含注音词的句子不能登记为语句

分配朗读（割り当て）：将音源从ボイス菜单拖动到文本框，或者编辑文本（例：琴葉 茜 - カスタム＞），朗读时遇到这个标签就会切换到对应音源

词典优先度调到低可能有bug，用户最好只用标准/高优先度

# 护肤品

1. **洗面奶**：洁面。有效成分是**表面活性剂**，洁面用的基本都是阴离子表活，又可以细分为皂基（脂肪酸盐，比如硬脂酸盐、肉豆蔻酸盐、月桂酸盐、棕榈酸盐，在配料表中写成酸+碱的就是皂化配方）、硫酸酯类（比如SLS和SLES）和氨基（氨基酸盐，一般都是XX酰XX酸盐），三者的碱性、刺激性和清洁能力都递减。清洁能力过强的，有可能反而破坏正常油脂平衡，导致油脂腺负反馈调节分泌更多油脂，因此要根据肤质合理选择，切忌洗完后脸上紧绷的
2. 爽肤水：有效成分是水+保湿剂，有补水效果，但是一般比较鸡肋。有的商家宣传能够收缩毛孔，是没什么科学依据的，毛孔粗大原因很多种，比如油脂分泌过多（解决方法：合理清洁）、角质（解决方法：果酸，水杨酸，酵素）、衰老，不可能喷个水就解决了
3. 精华：各种包含护肤有效成分的产品的统称（其实没有明确定义，噱头众多）
4. **乳液/面霜**：保湿。有效成分是**水**+**保湿剂**（甘油、丙二醇、透明质酸等）+**封闭剂**（阻止水分蒸发，角鲨烷、油脂等），根据乳化工艺不同分出了乳液（水包油）和面霜（油包水）。一般来说面霜油脂含量更高保湿能力更强，乳液反之
5. 眼霜：由于眼周皮脂腺少，提供额外保湿。必要性不那么大。商家宣传能够改善眼袋/黑眼圈，但是没有科学证据证明哪种成分是有效的
6. **防晒**：护肤品界将紫外线大致分成UVA（长波紫外线，与皮肤癌、皮肤老化有关）和UVB（中波紫外线，与晒黑、晒伤有关）。常用评价标准：SPF（**S**un **P**rotection **F**actor），防护晒伤（主要是UVB）的能力；PA（**P**rotection of UV**A**），防护UVA的能力。阳光强烈时应选择SPF 30或以上、PA++或以上（不过，高防晒能力必然伴随高浓度散射剂和吸收剂，带来皮肤刺激和安全隐患。而且随着散射剂和吸收剂浓度增加，紫外线透过率也应该是指数下降，随着浓度增加，屏蔽效果增长越来越不明显）有调查显示很多人涂得都不够，所以追求更高防护能力不如正确涂防晒（2mg/cm^2）

[成分查询分析](http://cosdna.com/chs/)

# 制表符

```
┌─┬─┐
│ │ │
├─┼─┤
│ │ │
└─┴─┘

　全角空格nbsp
```

# Mugen隔离技术

[参考1](https://tieba.baidu.com/p/5092155802)，[参考2](https://www.bilibili.com/read/cv22699148)

隔离技术是利用了Mugen引擎漏洞的技术。使用了隔离技术的角色称为隔离组；不用隔离技术就杀不死的角色属于防御型论外；能杀死防御型论外角色属于攻击型论外（这个分类法应该是10年代前半的，现在用了隔离技术的角色几乎100%同时属于三个类别）

## 原理

**512超越**

Mugen同时运作的控制器上限是512个，但是，处于`hitpausetime`（击中对手时的停顿）时即使超过512个也不报错，多出来的控制器会覆盖原本内存的内容。第500~600个控制器的内存区域刚好是自己的角色参数，配置控制器参数可以给自己锁血，刷攻击等；大约7000多个控制器的内存是对手的参数，可以将对手`alive`设置0

使用512超越覆盖返回地址，就能执行任意代码

**`%n`漏洞与`%f`漏洞**

Mugen引擎调用剪贴板的代码缺少检查用户输入导致了这两个漏洞。利用`%n`漏洞可以写任意地址内存，进一步用`%f`漏洞执行任意代码

`%n`漏洞原理：printf等函数中，`%n`将已经打印的字符数量写到该地址。一般的编译选项禁用`%n`，但Mugen不知为何允许使用。下面的代码中，`%*d`输出了宽度为48个字符的数字0，`%n`向`0x4b4048`地址写入48，实现了任意写内存

```c
printf("%*d%n", 48, 0, 0x4b4048);  // %n漏洞：覆盖内存
```

进一步用`%f`漏洞执行任意代码的方式是

1. 通过`%n`漏洞劫持GOT表（储存各个函数地址的表），将某个会被`%f`调用的函数地址改写到别的地方
2. 在改写到的地方用`%n`漏洞写入恶意代码
3. 执行`printf("%f", 1)`，过程中会调用上一步的恶意代码。`%f`应该不是唯一方法，但它的触发非常稳定

补充：此漏洞属于字符串格式化漏洞。因为`printf`函数族不检查参数合法性，很多软件都有类似的漏洞，并且有很多利用方法，比如

```c
printf("%x");    // 给的参数少于输出的个数，会把栈的下一个数打印出来
printf("%s%s");  // 同上，但是字符串会打印下一个数指向的内存位置，可以用于读内存，也可以指向某些奇怪位置让程序崩溃
```

**`StateDef`溢出**

人物状态文件（定义以及控制人物画像、移动、数值等）中使用`StateDef`语句定义状态号。如果状态号超过64字节，在读取的时候会导致栈溢出，覆盖掉栈中部分内容。用此方法覆盖掉一个返回地址，就能执行任意代码

三种隔离技术相比，512漏洞需要战斗开始之后才能启动；`%n`漏洞在战斗开始那一帧就可以启动；`StateDef`溢出在人物选择时就已经启动了，三者能做到的事差不多但速度上天差地别

**zlib溢出**

利用zlib 1.1.4的漏洞实现。比Statedef溢出更快，但是需要特定的Mugen版本才能实现，触发稳定性问题也尚未解决，还处于研究阶段

## 应用

用法非常非常多，仅举一些常见的例子

- 按键操作，比如把当前按键改成F1，即秒杀P2的调试按键
- 直死：将对手`alive`值设为0
- Player消除：将对手`exist`值设为0
- CNS操作：CNS存放人物代码，将对手CNS修改为空，或者改成其他角色，能阻止对手使用隔离技术

# 柯里化

柯里化（Currying）是将一个多参数函数变成嵌套的单参数函数。柯里化的好处是，有的情况下使用单一参数的闭包较为方便，有时甚至不得不使用单参数函数。一个简单的例子是：

```javascript
// 普通的求和函数
function sum(a, b) {
    return a + b;
}

// 柯里化的求和函数。调用它返回函数plus_a，再次调用plus_a得到结果
function curry_sum(a) {
    const plus_a = (b) => (a + b)
    return plus_a
}

sum(1, 2)
curry_sum(1)(2)
```

## 理论分析与记号

给定函数$f: (x, y) \mapsto z$，构造函数$h_x: y \mapsto z$使得$h_x(y) = f(x, y)$，$h_x$就是$f$的一种柯里化表示。通俗的讲，$h_x$就是垂直$f(x, y)$图像x轴“切了一刀”

这种柯里化表示标记为$h = (x \mapsto (y \mapsto z))$，定义箭头是右结合的，又写作$h = x \mapsto y \mapsto z$
